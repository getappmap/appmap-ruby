This source code is copied from https://github.com/banister/method_source.
